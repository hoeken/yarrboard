{"version":3,"file":"sockette.es.js","sources":["../src/index.js"],"sourcesContent":["function noop() {}\n\nexport default function (url, opts) {\n\topts = opts || {};\n\n\tlet k, ws, num, $={}, self=this;\n\tlet ms=opts.timeout || 1e3, max=opts.maxAttempts || Infinity;\n\n\t$.onmessage = opts.onmessage || noop;\n\n\t$.onclose = e => {\n\t\t(e.code !== 1e3 && e.code !== 1005) && self.reconnect(e);\n\t\t(opts.onclose || noop)(e);\n\t};\n\n\t$.onerror = e => {\n\t\t(e && e.code==='ECONNREFUSED') ? self.reconnect(e) : (opts.onerror || noop)(e);\n\t};\n\n\t$.onopen = e => {\n\t\tnum=0; (opts.onopen || noop)(e);\n\t};\n\n\tself.open = () => {\n\t\tws = new WebSocket(url, opts.protocols);\n\t\tfor (k in $) ws[k] = $[k];\n\t};\n\n\tself.reconnect = e => {\n\t\t(num++ < max) ? setTimeout(_ => {\n\t\t\t(opts.onreconnect || noop)(e);\n\t\t\tself.open();\n\t\t}, ms) : (opts.onmaximum || noop)(e);\n\t};\n\n\tself.json = x => {\n\t\tws.send(JSON.stringify(x));\n\t};\n\n\tself.send = x => {\n\t\tws.send(x);\n\t};\n\n\tself.close = (x, y) => {\n\t\tws.close(x, y);\n\t};\n\n\tself.open(); // init\n\n\treturn self;\n}\n"],"names":["noop","url","opts","let","k","ws","num","$","self","this","ms","timeout","max","maxAttempts","Infinity","onmessage","onclose","e","code","reconnect","onerror","onopen","open","WebSocket","protocols","setTimeout","_","onreconnect","onmaximum","json","x","send","JSON","stringify","close","y"],"mappings":"AAAA,SAASA,oBAET,SAAyBC,EAAKC,GAG7BC,IAAIC,EAAGC,EAAIC,EAAKC,KAAMC,EAAKC,KACvBC,GAHJR,EAAOA,OAGKS,SAAW,IAAKC,EAAIV,EAAKW,aAAeC,SA2CpD,OAzCAP,EAAEQ,UAAYb,EAAKa,WAAaf,EAEhCO,EAAES,iBAAUC,GACC,MAAXA,EAAEC,MAA2B,OAAXD,EAAEC,MAAkBV,EAAKW,UAAUF,IACrDf,EAAKc,SAAWhB,GAAMiB,IAGxBV,EAAEa,iBAAUH,GACVA,GAAc,iBAATA,EAAEC,KAAyBV,EAAKW,UAAUF,IAAMf,EAAKkB,SAAWpB,GAAMiB,IAG7EV,EAAEc,gBAASJ,GACVX,EAAI,GAAIJ,EAAKmB,QAAUrB,GAAMiB,IAG9BT,EAAKc,gBAEJ,IAAKlB,KADLC,EAAK,IAAIkB,UAAUtB,EAAKC,EAAKsB,WACnBjB,EAAGF,EAAGD,GAAKG,EAAEH,IAGxBI,EAAKW,mBAAYF,GACfX,IAAQM,EAAOa,oBAAWC,IACzBxB,EAAKyB,aAAe3B,GAAMiB,GAC3BT,EAAKc,QACHZ,IAAOR,EAAK0B,WAAa5B,GAAMiB,IAGnCT,EAAKqB,cAAOC,GACXzB,EAAG0B,KAAKC,KAAKC,UAAUH,KAGxBtB,EAAKuB,cAAOD,GACXzB,EAAG0B,KAAKD,IAGTtB,EAAK0B,eAASJ,EAAGK,GAChB9B,EAAG6B,MAAMJ,EAAGK,IAGb3B,EAAKc,OAEEd"}